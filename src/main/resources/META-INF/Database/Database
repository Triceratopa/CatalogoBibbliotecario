CREATE TABLE Pubblicazione (
ISBN VARCHAR(50) PRIMARY KEY,
Titolo VARCHAR(50) NOT NULL,
AnnoPubblicazione INT NOT NULL CHECK (AnnoPubblicazione > 0),
NumeroPagine INT NOT NULL CHECK (NumeroPagine>0)
);
CREATE TABLE Autore(
AutoreID SERIAL PRIMARY KEY,
Nome VARCHAR(50) NOT NULL,
Cognome VARCHAR(50) NOT NULL
);
CREATE TABLE Genere(
GenereID SERIAL PRIMARY KEY,
Nome VARCHAR(50) NOT NULL
);
CREATE TABLE Libri (
ISBN VARCHAR(50) PRIMARY KEY,
AutoreID INT NOT NULL,
GenereID INT NOT NULL,
CONSTRAINT FK_Libri_Pubblicazione FOREIGN KEY (ISBN) REFERENCES Pubblicazione (ISBN),
CONSTRAINT FK_Libri_Autore FOREIGN KEY (AutoreID) REFERENCES Autore (AutoreID),
CONSTRAINT FK_Libri_Genere FOREIGN KEY (GenereID) REFERENCES Genere(GenereID)
);
CREATE TABLE Riviste (
ISBN VARCHAR(50) PRIMARY KEY,
Periodicità VARCHAR(50) NOT NULL CHECK(Periodicità IN ('SETTIMANALE', 'MENSILE', 'SEMESTRALE')),
CONSTRAINT FK_Riviste_Pubblicazione FOREIGN KEY (ISBN) REFERENCES Pubblicazione (ISBN)
);
CREATE TABLE Utente(
Nome VARCHAR(50) NOT NULL,
Cognome VARCHAR(50) NOT NULL,
DataDiNascita DATA NOT NULL,
UtenteID INT PRIMARY KEY
);
CREATE TABLE Prestito(
PrestitoID SERIAL PRIMARY KEY,
UtenteID INT NOT NULL,
ISBN VARCHAR(50) NOT NULL,
DataInizio DATA NOT NULL,
DataResPrevista DATA NOT NULL CHECK(DataResPrevista=DataInizio+30),
DataResEffettuata DATA NOT NULL,
CONSTRAINT FK_Prestito_Pubblicazione FOREIGN KEY (ISBN) REFERENCES Pubblicazione (ISBN),
CONSTRAINT FK_Prestito_Utente FOREIGN KEY (UtenteID) REFERENCES Utente (UtenteID)
)
